/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package gui;

import Conexion.Conexion;
import com.alee.managers.notification.NotificationIcon;
import com.alee.managers.notification.NotificationManager;
import java.io.BufferedReader;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;
import java.util.HashMap;
import java.util.Map;
import javax.swing.JOptionPane;
import javax.swing.SpinnerNumberModel;
import javax.swing.table.DefaultTableModel;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JasperCompileManager;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.design.JasperDesign;
import net.sf.jasperreports.engine.xml.JRXmlLoader;
import net.sf.jasperreports.view.JasperViewer;

/**
 *
 * @author Personals
 */
public class JIF_Factura extends javax.swing.JInternalFrame {

    public static double precioT;

    /**
     * Creates new form Factura
     */
    public JIF_Factura() {
        initComponents();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jp_Vendedor = new javax.swing.JPanel();
        jl_CodigoVendedor = new javax.swing.JLabel();
        jt_CodigoVendedor = new javax.swing.JTextField();
        jb_BuscarEmpleado = new javax.swing.JButton();
        jl_InfoNomVendedor = new javax.swing.JLabel();
        jl_NomVendedor = new javax.swing.JLabel();
        jc_Sesion = new javax.swing.JCheckBox();
        jp_Producto = new javax.swing.JPanel();
        jl_CodigoProducto = new javax.swing.JLabel();
        jt_CodigoProducto = new javax.swing.JTextField();
        jb_BuscarProducto = new javax.swing.JButton();
        jl_InfoPrecio = new javax.swing.JLabel();
        jl_PrecioProducto = new javax.swing.JLabel();
        jl_NombreProducto = new javax.swing.JLabel();
        jl_CantidadProducto = new javax.swing.JLabel();
        js_Cantidad = new javax.swing.JSpinner();
        jb_AgregarProducto = new javax.swing.JButton();
        jc_DescuentoProducto = new javax.swing.JCheckBox();
        jl_InfoUnidDispoProducto = new javax.swing.JLabel();
        jt_UnidDispoProducto = new javax.swing.JTextField();
        jl_InfoPrecioT = new javax.swing.JLabel();
        jl_PrecioProductoT = new javax.swing.JLabel();
        js_DescuentoProducto = new javax.swing.JSpinner();
        jp_Venta = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        jta_Venta = new javax.swing.JTable();
        jb_Facturar = new javax.swing.JButton();
        jp_Cliente = new javax.swing.JPanel();
        jl_CodCliente = new javax.swing.JLabel();
        jt_CodigoCliente = new javax.swing.JTextField();
        jb_BuscarCliente = new javax.swing.JButton();
        jl_InfoNomCliente = new javax.swing.JLabel();
        jl_NomCliente = new javax.swing.JLabel();
        jl_InfoFactura = new javax.swing.JLabel();
        jl_NumeroFactura = new javax.swing.JLabel();
        jl_Fecha = new javax.swing.JLabel();
        jl_InfoPrecioTotal = new javax.swing.JLabel();
        jl_PrecioTotal = new javax.swing.JLabel();
        jl_InfoFecha = new javax.swing.JLabel();
        jl_InfoTienda = new javax.swing.JLabel();
        jl_Tienda = new javax.swing.JLabel();

        setClosable(true);
        setIconifiable(true);
        setTitle("Factura");

        jp_Vendedor.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Información vendedor", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 0, 14))); // NOI18N

        jl_CodigoVendedor.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_CodigoVendedor.setText("Código vendedor");

        jt_CodigoVendedor.setToolTipText("Código del vendedor");
        jt_CodigoVendedor.setEnabled(false);

        jb_BuscarEmpleado.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imágenes/img_buscar.png"))); // NOI18N
        jb_BuscarEmpleado.setToolTipText("Buscador de empleados");
        jb_BuscarEmpleado.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_BuscarEmpleadoActionPerformed(evt);
            }
        });

        jl_InfoNomVendedor.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_InfoNomVendedor.setText("Nombre del vendedor:");

        jl_NomVendedor.setText(" ");

        jc_Sesion.setText("Sesión");
        jc_Sesion.setToolTipText("<html>\nMarque esta opción si el vendedor <p>es el mismo de la sesión\n</html>");
        jc_Sesion.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jc_SesionItemStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jp_VendedorLayout = new javax.swing.GroupLayout(jp_Vendedor);
        jp_Vendedor.setLayout(jp_VendedorLayout);
        jp_VendedorLayout.setHorizontalGroup(
            jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_VendedorLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jl_NomVendedor, javax.swing.GroupLayout.PREFERRED_SIZE, 244, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(jp_VendedorLayout.createSequentialGroup()
                        .addGroup(jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addGroup(jp_VendedorLayout.createSequentialGroup()
                                .addComponent(jl_InfoNomVendedor)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(jc_Sesion))
                            .addGroup(jp_VendedorLayout.createSequentialGroup()
                                .addComponent(jl_CodigoVendedor)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jt_CodigoVendedor, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jb_BuscarEmpleado, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jp_VendedorLayout.setVerticalGroup(
            jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_VendedorLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jl_CodigoVendedor)
                    .addComponent(jt_CodigoVendedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jb_BuscarEmpleado))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jp_VendedorLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jl_InfoNomVendedor)
                    .addComponent(jc_Sesion))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jl_NomVendedor)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jp_Producto.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Información producto", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 0, 14))); // NOI18N
        jp_Producto.setEnabled(false);

        jl_CodigoProducto.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_CodigoProducto.setText("Código producto");

        jt_CodigoProducto.setToolTipText("Código del producto");
        jt_CodigoProducto.setEnabled(false);

        jb_BuscarProducto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imágenes/img_buscar.png"))); // NOI18N
        jb_BuscarProducto.setToolTipText("Buscador de productos");
        jb_BuscarProducto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_BuscarProductoActionPerformed(evt);
            }
        });

        jl_InfoPrecio.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_InfoPrecio.setText("Precio c/u");

        jl_PrecioProducto.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jl_PrecioProducto.setForeground(new java.awt.Color(0, 102, 0));
        jl_PrecioProducto.setText("$$");
        jl_PrecioProducto.setToolTipText("Precio c/u del producto");
        jl_PrecioProducto.setEnabled(false);
        jl_PrecioProducto.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        jl_NombreProducto.setText(" ");
        jl_NombreProducto.setToolTipText("Nombre del producto");

        jl_CantidadProducto.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_CantidadProducto.setText("Cantidad");

        js_Cantidad.setModel(new javax.swing.SpinnerNumberModel(Integer.valueOf(1), Integer.valueOf(1), null, Integer.valueOf(1)));
        js_Cantidad.setToolTipText("Cantidad de productos a comprar");
        js_Cantidad.setEnabled(false);
        js_Cantidad.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                js_CantidadStateChanged(evt);
            }
        });

        jb_AgregarProducto.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imágenes/img_nuevo.png"))); // NOI18N
        jb_AgregarProducto.setText("Agregar");
        jb_AgregarProducto.setToolTipText("Agregar producto(s) a la factura");
        jb_AgregarProducto.setEnabled(false);
        jb_AgregarProducto.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_AgregarProductoActionPerformed(evt);
            }
        });

        jc_DescuentoProducto.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jc_DescuentoProducto.setText("Dto");
        jc_DescuentoProducto.setToolTipText("Marque esta opción si se aplica algún descuento al producto");
        jc_DescuentoProducto.setEnabled(false);
        jc_DescuentoProducto.addItemListener(new java.awt.event.ItemListener() {
            public void itemStateChanged(java.awt.event.ItemEvent evt) {
                jc_DescuentoProductoItemStateChanged(evt);
            }
        });

        jl_InfoUnidDispoProducto.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_InfoUnidDispoProducto.setText("Unid. disp.");

        jt_UnidDispoProducto.setToolTipText("Unidades dispo. del producto");
        jt_UnidDispoProducto.setEnabled(false);

        jl_InfoPrecioT.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_InfoPrecioT.setText("Precio T.");

        jl_PrecioProductoT.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jl_PrecioProductoT.setForeground(new java.awt.Color(0, 102, 0));
        jl_PrecioProductoT.setText("$$");
        jl_PrecioProductoT.setToolTipText("Precio total de lo(s) producto(s)");
        jl_PrecioProductoT.setEnabled(false);
        jl_PrecioProductoT.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);

        js_DescuentoProducto.setModel(new javax.swing.SpinnerNumberModel(0, 0, 100, 1));
        js_DescuentoProducto.setToolTipText("El descuento se ve reflejado sólo en el precio total");
        js_DescuentoProducto.setEnabled(false);
        js_DescuentoProducto.addChangeListener(new javax.swing.event.ChangeListener() {
            public void stateChanged(javax.swing.event.ChangeEvent evt) {
                js_DescuentoProductoStateChanged(evt);
            }
        });

        javax.swing.GroupLayout jp_ProductoLayout = new javax.swing.GroupLayout(jp_Producto);
        jp_Producto.setLayout(jp_ProductoLayout);
        jp_ProductoLayout.setHorizontalGroup(
            jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_ProductoLayout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jp_ProductoLayout.createSequentialGroup()
                        .addComponent(jl_NombreProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 501, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(jl_InfoUnidDispoProducto)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jt_UnidDispoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 50, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jl_CantidadProducto))
                    .addGroup(jp_ProductoLayout.createSequentialGroup()
                        .addComponent(jl_CodigoProducto)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jt_CodigoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jb_BuscarProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jl_InfoPrecio)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jl_PrecioProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jl_InfoPrecioT)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jl_PrecioProductoT, javax.swing.GroupLayout.PREFERRED_SIZE, 130, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jc_DescuentoProducto)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addComponent(js_DescuentoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, 54, Short.MAX_VALUE)
                    .addComponent(js_Cantidad))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jb_AgregarProducto)
                .addGap(20, 20, 20))
        );
        jp_ProductoLayout.setVerticalGroup(
            jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_ProductoLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jp_ProductoLayout.createSequentialGroup()
                        .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jc_DescuentoProducto)
                                .addComponent(js_DescuentoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jl_InfoPrecioT)
                                .addComponent(jl_PrecioProductoT, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                            .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                .addComponent(jl_CodigoProducto)
                                .addComponent(jt_CodigoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addComponent(jb_BuscarProducto)
                                .addComponent(jl_InfoPrecio)
                                .addComponent(jl_PrecioProducto, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jp_ProductoLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jl_NombreProducto)
                            .addComponent(jl_CantidadProducto)
                            .addComponent(js_Cantidad, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jl_InfoUnidDispoProducto)
                            .addComponent(jt_UnidDispoProducto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(2, 2, 2))
                    .addComponent(jb_AgregarProducto, javax.swing.GroupLayout.Alignment.TRAILING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap())
        );

        jp_Venta.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Venta", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 0, 14))); // NOI18N

        jta_Venta.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Código", "Nombre", "Precio C/U", "Cant.", "Precio Total", "Dto"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        jta_Venta.setEnabled(false);
        jta_Venta.getTableHeader().setReorderingAllowed(false);
        jta_Venta.addKeyListener(new java.awt.event.KeyAdapter() {
            public void keyTyped(java.awt.event.KeyEvent evt) {
                jta_VentaKeyTyped(evt);
            }
        });
        jScrollPane1.setViewportView(jta_Venta);
        if (jta_Venta.getColumnModel().getColumnCount() > 0) {
            jta_Venta.getColumnModel().getColumn(0).setPreferredWidth(50);
            jta_Venta.getColumnModel().getColumn(1).setPreferredWidth(400);
            jta_Venta.getColumnModel().getColumn(3).setPreferredWidth(5);
            jta_Venta.getColumnModel().getColumn(5).setPreferredWidth(5);
        }

        javax.swing.GroupLayout jp_VentaLayout = new javax.swing.GroupLayout(jp_Venta);
        jp_Venta.setLayout(jp_VentaLayout);
        jp_VentaLayout.setHorizontalGroup(
            jp_VentaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_VentaLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1)
                .addContainerGap())
        );
        jp_VentaLayout.setVerticalGroup(
            jp_VentaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_VentaLayout.createSequentialGroup()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 228, Short.MAX_VALUE)
                .addContainerGap())
        );

        jb_Facturar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imágenes/img_imprimir.png"))); // NOI18N
        jb_Facturar.setText("Facturar");
        jb_Facturar.setToolTipText("Haga clic aquí para generar la factura");
        jb_Facturar.setEnabled(false);
        jb_Facturar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_FacturarActionPerformed(evt);
            }
        });

        jp_Cliente.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Información cliente", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Segoe UI", 0, 14))); // NOI18N

        jl_CodCliente.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_CodCliente.setText("Código cliente");

        jt_CodigoCliente.setToolTipText("Código del cliente");
        jt_CodigoCliente.setEnabled(false);

        jb_BuscarCliente.setIcon(new javax.swing.ImageIcon(getClass().getResource("/Imágenes/img_buscar.png"))); // NOI18N
        jb_BuscarCliente.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jb_BuscarClienteActionPerformed(evt);
            }
        });

        jl_InfoNomCliente.setFont(new java.awt.Font("Arial", 1, 12)); // NOI18N
        jl_InfoNomCliente.setText("Nombre del cliente:");

        jl_NomCliente.setText(" ");

        javax.swing.GroupLayout jp_ClienteLayout = new javax.swing.GroupLayout(jp_Cliente);
        jp_Cliente.setLayout(jp_ClienteLayout);
        jp_ClienteLayout.setHorizontalGroup(
            jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_ClienteLayout.createSequentialGroup()
                .addGroup(jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jp_ClienteLayout.createSequentialGroup()
                        .addComponent(jl_CodCliente)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jt_CodigoCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jb_BuscarCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 39, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jp_ClienteLayout.createSequentialGroup()
                        .addGroup(jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(jl_InfoNomCliente)
                            .addComponent(jl_NomCliente, javax.swing.GroupLayout.PREFERRED_SIZE, 244, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 0, Short.MAX_VALUE)))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        jp_ClienteLayout.setVerticalGroup(
            jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jp_ClienteLayout.createSequentialGroup()
                .addContainerGap()
                .addGroup(jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jb_BuscarCliente)
                    .addGroup(jp_ClienteLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(jl_CodCliente)
                        .addComponent(jt_CodigoCliente, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jl_InfoNomCliente)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(jl_NomCliente)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );

        jl_InfoFactura.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jl_InfoFactura.setText("Factura");

        jl_NumeroFactura.setFont(new java.awt.Font("Arial", 0, 18)); // NOI18N
        jl_NumeroFactura.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jl_NumeroFactura.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jl_Fecha.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jl_Fecha.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jl_Fecha.setText(" ");
        jl_Fecha.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        jl_InfoPrecioTotal.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jl_InfoPrecioTotal.setText("Precio Total");

        jl_PrecioTotal.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jl_PrecioTotal.setForeground(new java.awt.Color(0, 102, 0));
        jl_PrecioTotal.setText("0");
        jl_PrecioTotal.setEnabled(false);

        jl_InfoFecha.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jl_InfoFecha.setText("Fecha");

        jl_InfoTienda.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jl_InfoTienda.setText("Tienda");

        jl_Tienda.setFont(new java.awt.Font("Tahoma", 0, 18)); // NOI18N
        jl_Tienda.setHorizontalAlignment(javax.swing.SwingConstants.RIGHT);
        jl_Tienda.setBorder(javax.swing.BorderFactory.createEtchedBorder());

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jl_InfoPrecioTotal)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(jl_PrecioTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 200, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(jb_Facturar, javax.swing.GroupLayout.PREFERRED_SIZE, 137, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(jp_Venta, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(javax.swing.GroupLayout.Alignment.LEADING, layout.createSequentialGroup()
                        .addComponent(jp_Vendedor, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(jp_Cliente, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addGroup(layout.createSequentialGroup()
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                .addComponent(jl_InfoFactura))
                            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                                .addGap(10, 10, 10)
                                .addComponent(jl_InfoFecha, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE))
                            .addGroup(layout.createSequentialGroup()
                                .addGap(10, 10, 10)
                                .addComponent(jl_InfoTienda, javax.swing.GroupLayout.PREFERRED_SIZE, 69, javax.swing.GroupLayout.PREFERRED_SIZE)))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jl_Fecha, javax.swing.GroupLayout.PREFERRED_SIZE, 206, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jl_Tienda, javax.swing.GroupLayout.PREFERRED_SIZE, 206, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(jl_NumeroFactura, javax.swing.GroupLayout.PREFERRED_SIZE, 206, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(0, 9, Short.MAX_VALUE))
                    .addComponent(jp_Producto, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                            .addComponent(jp_Vendedor, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                            .addComponent(jp_Cliente, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                    .addGroup(layout.createSequentialGroup()
                        .addGap(25, 25, 25)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jl_InfoFactura)
                            .addComponent(jl_NumeroFactura, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(23, 23, 23)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jl_InfoFecha)
                            .addComponent(jl_Fecha, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(17, 17, 17)
                        .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(jl_InfoTienda)
                            .addComponent(jl_Tienda, javax.swing.GroupLayout.PREFERRED_SIZE, 22, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jp_Producto, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jp_Venta, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(jb_Facturar, javax.swing.GroupLayout.PREFERRED_SIZE, 32, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jl_InfoPrecioTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(jl_PrecioTotal, javax.swing.GroupLayout.PREFERRED_SIZE, 28, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap(15, Short.MAX_VALUE))
        );

        final DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd");
        final Calendar cal = Calendar.getInstance();
        jl_Fecha.setText(dateFormat.format(cal.getTime()));

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jb_BuscarEmpleadoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_BuscarEmpleadoActionPerformed
        Frm_BuscadorEmpleado frm_BuscadorEmpleado = new Frm_BuscadorEmpleado();
        frm_BuscadorEmpleado.main(new String[]{""});
    }//GEN-LAST:event_jb_BuscarEmpleadoActionPerformed

    private void jb_BuscarClienteActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_BuscarClienteActionPerformed
        Frm_BuscadorCliente frm_BuscadorCliente = new Frm_BuscadorCliente();
        frm_BuscadorCliente.main(new String[]{""});
    }//GEN-LAST:event_jb_BuscarClienteActionPerformed

    private void jb_BuscarProductoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_BuscarProductoActionPerformed
        if (jl_Tienda.getText().length() == 0 || jl_NumeroFactura.getText().length() == 0) {
            NotificationManager.showNotification("Primero seleccione el vendedor y el cliente", NotificationIcon.information.getIcon()).setDisplayTime(5000);
        } else {
            Frm_BuscadorProductoFac frm_BuscadorProducto = new Frm_BuscadorProductoFac();
            frm_BuscadorProducto.main(new String[]{""});
        }
    }//GEN-LAST:event_jb_BuscarProductoActionPerformed

    public static void nuevoCodFactura() {
        precioT = 0;
        try {
            Conexion c = new Conexion();
            Statement s = c.c.createStatement();
            String codVendedor = jt_CodigoVendedor.getText();
            String docCliente = jt_CodigoCliente.getText();
            String sentence = "CALL sp_codNuevaFactura(\'" + codVendedor + "\',\'" + docCliente + "\')";
            ResultSet r = s.executeQuery(sentence);
            if (r.next()) {
                int numFactura = Integer.parseInt(r.getString(1));
                jl_NumeroFactura.setText(numFactura + "");
            }
            c.c.close();
        } catch (ClassNotFoundException | SQLException ex) {
            //JOptionPane.showMessageDialog(this, ex.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }
    }

    public static void cargarUnidDisponibles(String idProducto) {
        try {
            if (jl_Tienda.getText().length() != 0) {
                Conexion c = new Conexion();
                Statement s = c.c.createStatement();
                String sentence = "CALL sp_unidDispoProducto(" + idProducto + "," + jl_Tienda.getText() + ")";
                ResultSet r = s.executeQuery(sentence);
                if (r.next()) {
                    int unidDispo = Integer.parseInt(r.getString(1));
                    boolean exists = false;
                    DefaultTableModel dtm = (DefaultTableModel) jta_Venta.getModel();
                    for (int i = 0; i < jta_Venta.getRowCount(); i++) {
                        if (dtm.getValueAt(i, 0).equals(idProducto + "")) {
                            unidDispo -= Integer.parseInt(dtm.getValueAt(i, 3).toString());
                        }
                    }
                    SpinnerNumberModel snm;
                    if (unidDispo > 0) {
                        snm = new SpinnerNumberModel(1, 1, unidDispo, 1);
                        jb_AgregarProducto.setEnabled(true);
                        JIF_Factura.cambioEstadoProducto(true);
                    } else {
                        jt_CodigoProducto.setText("");
                        jl_NombreProducto.setText("No hay disponiblidad del producto");
                        jl_PrecioProducto.setText("$$");
                        jl_PrecioProductoT.setText("$$");
                        jc_DescuentoProducto.setSelected(false);
                        js_DescuentoProducto.setValue(new Integer(0));
                        JIF_Factura.cambioEstadoProducto(false);
                        snm = new SpinnerNumberModel(0, 0, 0, 0);
                        jb_AgregarProducto.setEnabled(false);
                        //JOptionPane.showMessageDialog(this, "No ha disponibilidad del producto");
                    }
                    js_Cantidad.setModel(snm);
                    jt_UnidDispoProducto.setText(unidDispo + "");
                } else {
                    //JOptionPane.showMessageDialog(this, "Error al generar nueva factura", "Error", JOptionPane.ERROR_MESSAGE);
                }
                c.c.close();
            }
        } catch (ClassNotFoundException | SQLException ex) {
            //JOptionPane.showMessageDialog(this, ex.getMessage(), "Error", JOptionPane.ERROR_MESSAGE);
        }

    }

    public static void cambioEstadoProducto(boolean state) {
        jb_AgregarProducto.setEnabled(state);
        jl_PrecioProducto.setEnabled(state);
        jl_PrecioProductoT.setEnabled(state);
        jc_DescuentoProducto.setEnabled(state);
        js_Cantidad.setEnabled(state);
        js_DescuentoProducto.setEnabled(state);
    }

    public static void cambioEstadoFactura(boolean state) {
        jta_Venta.setEnabled(state);
        jl_PrecioTotal.setEnabled(state);
        jb_Facturar.setEnabled(state);
    }

    private void jc_SesionItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jc_SesionItemStateChanged
        if (jc_Sesion.isSelected()) {
            jt_CodigoVendedor.setText(Frm_Principal.cedula);
            jl_NomVendedor.setText(Frm_Principal.nombre);
            jl_Tienda.setText(Frm_Principal.idTienda);
            jb_BuscarEmpleado.setEnabled(false);
        } else {
            jb_BuscarEmpleado.setEnabled(true);
            jt_CodigoVendedor.setText("");
            jl_Tienda.setText("");
        }
    }//GEN-LAST:event_jc_SesionItemStateChanged

    private void jc_DescuentoProductoItemStateChanged(java.awt.event.ItemEvent evt) {//GEN-FIRST:event_jc_DescuentoProductoItemStateChanged
        SpinnerNumberModel snm = new SpinnerNumberModel(0, 0, 100, 1);
        js_DescuentoProducto.setModel(snm);
        js_DescuentoProducto.setEnabled(jc_DescuentoProducto.isSelected());
        double preciocu = Double.parseDouble(jl_PrecioProducto.getText());
        int cantidad = Integer.parseInt(js_Cantidad.getValue().toString());
        jl_PrecioProductoT.setText(preciocu * cantidad + "");
    }//GEN-LAST:event_jc_DescuentoProductoItemStateChanged

    private void js_CantidadStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_js_CantidadStateChanged
        double preciocu = Double.parseDouble(jl_PrecioProducto.getText());
        double preciot = 0;
        int cantidad = Integer.parseInt(js_Cantidad.getValue().toString());
        double dto = Double.parseDouble(js_DescuentoProducto.getValue().toString());
        preciot = preciocu * cantidad;
        preciot -= (dto / 100.0) * preciot;
        jl_PrecioProductoT.setText(String.format("%.2f", preciot).replaceAll(",", ".") + "");
    }//GEN-LAST:event_js_CantidadStateChanged

    private void js_DescuentoProductoStateChanged(javax.swing.event.ChangeEvent evt) {//GEN-FIRST:event_js_DescuentoProductoStateChanged
        if (jc_DescuentoProducto.isSelected()) {
            double preciocu = Double.parseDouble(jl_PrecioProducto.getText());
            double preciot = 0;
            int cantidad = Integer.parseInt(js_Cantidad.getValue().toString());
            double dto = Double.parseDouble(js_DescuentoProducto.getValue().toString());
            preciot = preciocu * cantidad;
            preciot -= (dto / 100.0) * preciot;
            jl_PrecioProductoT.setText(String.format("%.2f", preciot).replaceAll(",", ".") + "");
        }
    }//GEN-LAST:event_js_DescuentoProductoStateChanged

    private void jb_AgregarProductoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_AgregarProductoActionPerformed
        DefaultTableModel dtm = (DefaultTableModel) jta_Venta.getModel();
        Object codigo = (Object) jt_CodigoProducto.getText();
        boolean exists = false;
        for (int i = 0; i < jta_Venta.getRowCount() && !exists; i++) {
            if (dtm.getValueAt(i, 0).toString().equals(codigo)) {
                exists = true;
            }
        }
        if (!exists) {
            Object nombre = (Object) jl_NombreProducto.getText();
            Object precio = (Object) jl_PrecioProducto.getText();
            Object cantidad = (Object) js_Cantidad.getValue().toString();
            Object preciot = (Object) jl_PrecioProductoT.getText();
            Object dto = (Object) js_DescuentoProducto.getValue().toString();
            Object[] o = new Object[]{codigo, nombre, precio, cantidad, preciot, dto};
            dtm.addRow(o);
            jta_Venta.setModel(dtm);
            jb_AgregarProducto.setEnabled(false);
            precioT += Double.parseDouble(jl_PrecioProductoT.getText());
            jl_PrecioTotal.setText(String.format("%.2f", precioT).replaceAll(",", "."));
            js_DescuentoProducto.setValue(new Integer(0));
            jt_UnidDispoProducto.setText("0");
            js_Cantidad.setValue(new Integer(0));
            jt_CodigoProducto.setText("");
            jl_PrecioProducto.setText("$$");
            jl_PrecioProductoT.setText("$$");
            jl_NombreProducto.setText("");
            cambioEstadoProducto(false);
        } else {
            NotificationManager.showNotification("<html>Ya se ha agregado este tipo de producto a la venta.<p>Si desea cambiar la cantidad del producto<p>seleccionelo en la tabla de venta y presione [Supr]<p>y vuelva a agregarlo</html>", NotificationIcon.information.getIcon()).setDisplayTime(5000);
        }
    }//GEN-LAST:event_jb_AgregarProductoActionPerformed

    private void jta_VentaKeyTyped(java.awt.event.KeyEvent evt) {//GEN-FIRST:event_jta_VentaKeyTyped
        if ((int) evt.getKeyChar() == 127 && jta_Venta.getSelectedRow() >= 0) {
            borrarFilaTabla(jta_Venta.getSelectedRow());
        }
    }//GEN-LAST:event_jta_VentaKeyTyped

    private void jb_FacturarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jb_FacturarActionPerformed
        if (jta_Venta.getRowCount() == 0) {
            NotificationManager.showNotification("No se ha agregado ningún producto(s) a la factura", NotificationIcon.information.getIcon()).setDisplayTime(5000);
        } else {
            DefaultTableModel dtm = (DefaultTableModel) jta_Venta.getModel();
            for (int i = 0; i < jta_Venta.getRowCount(); i++) {
                try {
                    String idFactura = jl_NumeroFactura.getText();
                    String codProducto = dtm.getValueAt(i, 0).toString();
                    String cantidad = dtm.getValueAt(i, 3).toString();
                    String dto = dtm.getValueAt(i, 5).toString();
                    Conexion c = new Conexion();
                    Statement s = c.c.createStatement();
                    String sentence = "CALL sp_agregarVenta(" + idFactura + "," + codProducto + "," + cantidad + "," + dto + ")";
                    s.executeQuery(sentence);
                    c.c.close();
                } catch (ClassNotFoundException | SQLException ex) {
                    NotificationManager.showNotification("No se pudo completar la facturación", NotificationIcon.error.getIcon()).setDisplayTime(5000);
                    try {
                        Conexion c = new Conexion();
                        Statement s = c.c.createStatement();
                        String idFactura = jl_NumeroFactura.getText();
                        String sentence = "CALL sp_borrarVentas(" + idFactura + ")";
                        s.executeQuery(sentence);
                        c.c.close();
                    } catch (ClassNotFoundException | SQLException exec) {
                        JOptionPane.showMessageDialog(this, exec.getMessage());
                    }
                }
            }
            try {
                //Llamar al reporte
                InputStream input = this.getClass().getResourceAsStream("/Util/ConfFactura.txt");
                BufferedReader in = new BufferedReader(new InputStreamReader(input));
                String cc = in.readLine();
                String ccLocal = in.readLine();
                String nombre = in.readLine();
                String nit = in.readLine();
                String mens1 = in.readLine();
                String mens2 = in.readLine();
                input = this.getClass().getResourceAsStream("/Reportes/rep_Factura.jrxml");
                JasperDesign design = JRXmlLoader.load(input);
                JasperReport report = JasperCompileManager.compileReport(design);
                Conexion c = new Conexion();
                Map map = new HashMap(10);
                map.put("CC", cc);
                map.put("CCLOCAL", ccLocal);
                map.put("NOMBRE", nombre);
                map.put("NIT", nit);
                map.put("MENS1", mens1);
                map.put("MENS2", mens2);
                map.put("CLIENTENOM", jl_NomCliente.getText());
                map.put("CLIENTEDOC", jt_CodigoCliente.getText());
                map.put("EMPLEADO", jl_NomVendedor.getText());
                map.put("FACTURA", jl_NumeroFactura.getText());
                JasperPrint print = JasperFillManager.fillReport(report, map, c.c);
                JasperViewer.viewReport(print, false);
                this.dispose();
            } catch (FileNotFoundException ex) {
                NotificationManager.showNotification("No se ha encontrado el archivo de configuración de las facturas", NotificationIcon.error.getIcon()).setDisplayTime(5000);
            } catch (IOException | ClassNotFoundException | SQLException | JRException ex) {
                NotificationManager.showNotification("Error al conectarse a la base de datos", NotificationIcon.error.getIcon()).setDisplayTime(5000);
            }
        }
    }//GEN-LAST:event_jb_FacturarActionPerformed

    private void borrarFilaTabla(int f) {
        String codigo = jta_Venta.getValueAt(f, 0).toString();
        String nombre = jta_Venta.getValueAt(f, 1).toString();
        double precio = Double.parseDouble(jta_Venta.getValueAt(f, 2).toString());
        int cantidad = Integer.parseInt(jta_Venta.getValueAt(f, 3).toString());
        double preciot = Double.parseDouble(jta_Venta.getValueAt(f, 4).toString());
        int dto = Integer.parseInt(jta_Venta.getValueAt(f, 5).toString());
        ((DefaultTableModel) jta_Venta.getModel()).removeRow(f);
        precioT -= preciot;
        jl_PrecioTotal.setText(String.format("%.2f", precioT).replaceAll(",", "."));
    }


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JScrollPane jScrollPane1;
    public static javax.swing.JButton jb_AgregarProducto;
    private javax.swing.JButton jb_BuscarCliente;
    private javax.swing.JButton jb_BuscarEmpleado;
    public static javax.swing.JButton jb_BuscarProducto;
    public static javax.swing.JButton jb_Facturar;
    private static javax.swing.JCheckBox jc_DescuentoProducto;
    private javax.swing.JCheckBox jc_Sesion;
    private javax.swing.JLabel jl_CantidadProducto;
    private javax.swing.JLabel jl_CodCliente;
    private javax.swing.JLabel jl_CodigoProducto;
    private javax.swing.JLabel jl_CodigoVendedor;
    private javax.swing.JLabel jl_Fecha;
    private javax.swing.JLabel jl_InfoFactura;
    private javax.swing.JLabel jl_InfoFecha;
    private javax.swing.JLabel jl_InfoNomCliente;
    private javax.swing.JLabel jl_InfoNomVendedor;
    private javax.swing.JLabel jl_InfoPrecio;
    private javax.swing.JLabel jl_InfoPrecioT;
    private javax.swing.JLabel jl_InfoPrecioTotal;
    private javax.swing.JLabel jl_InfoTienda;
    private javax.swing.JLabel jl_InfoUnidDispoProducto;
    public static javax.swing.JLabel jl_NomCliente;
    public static javax.swing.JLabel jl_NomVendedor;
    public static javax.swing.JLabel jl_NombreProducto;
    public static javax.swing.JLabel jl_NumeroFactura;
    public static javax.swing.JLabel jl_PrecioProducto;
    public static javax.swing.JLabel jl_PrecioProductoT;
    public static javax.swing.JLabel jl_PrecioTotal;
    public static javax.swing.JLabel jl_Tienda;
    private javax.swing.JPanel jp_Cliente;
    private javax.swing.JPanel jp_Producto;
    private javax.swing.JPanel jp_Vendedor;
    private javax.swing.JPanel jp_Venta;
    private static javax.swing.JSpinner js_Cantidad;
    private static javax.swing.JSpinner js_DescuentoProducto;
    public static javax.swing.JTextField jt_CodigoCliente;
    public static javax.swing.JTextField jt_CodigoProducto;
    public static javax.swing.JTextField jt_CodigoVendedor;
    private static javax.swing.JTextField jt_UnidDispoProducto;
    public static javax.swing.JTable jta_Venta;
    // End of variables declaration//GEN-END:variables
}
